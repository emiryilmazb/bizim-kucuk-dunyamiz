<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>Bizim KÃ¼Ã§Ã¼k DÃ¼nyamÄ±z ğŸŒğŸ’›</title>
    <meta name="description" content="Sevgililer gÃ¼nÃ¼ sÃ¼rprizi â€” anÄ±larÄ±mÄ±zÄ± keÅŸfet!" />
    <meta name="theme-color" content="#e8807f" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>

    <!-- ==========================================
         INTRO â€” Step 1: Opening
         ========================================== -->
    <div class="intro-step step-1 active" id="step-1">
      <canvas id="particles-canvas"></canvas>
      <div class="step-content">
        <div class="step1-heart">ğŸ’–</div>
        <p class="step1-text" id="step1-text"></p>
        <div class="step1-tap">dokun âœ¨</div>
      </div>
    </div>

    <!-- ==========================================
         INTRO â€” Step 2: Love Letter
         ========================================== -->
    <div class="intro-step step-2" id="step-2">
      <div class="step-content">
        <div class="letter-envelope" id="envelope">
          <div class="envelope-flap"></div>
          <div class="envelope-body">ğŸ’Œ</div>
        </div>
        <div class="letter-content" id="letter-content">
          <p class="letter-line" data-delay="0">Seninle tanÄ±ÅŸtÄ±ÄŸÄ±m gÃ¼nden beri</p>
          <p class="letter-line" data-delay="600">her ÅŸey daha gÃ¼zel ğŸŒ¸</p>
          <p class="letter-line" data-delay="1200">her an daha deÄŸerli ğŸ’«</p>
          <p class="letter-line" data-delay="1800">her gÃ¼n daha renkli oldu ğŸŒˆ</p>
        </div>
        <div class="step2-tap">dokun ğŸ’›</div>
      </div>
    </div>

    <!-- ==========================================
         INTRO â€” Step 3: Memories Reveal
         ========================================== -->
    <div class="intro-step step-3" id="step-3">
      <div class="step-content">
        <div class="memories-grid" id="memories-grid">
          <div class="mem-card"><span>ğŸ’•</span></div>
          <div class="mem-card"><span>ğŸŒ…</span></div>
          <div class="mem-card"><span>ğŸ­</span></div>
          <div class="mem-card"><span>ğŸ°</span></div>
          <div class="mem-card"><span>ğŸ¨</span></div>
          <div class="mem-card"><span>âœ¨</span></div>
        </div>
        <h2 class="step3-title" id="step3-title">Bu anÄ±larÄ± hatÄ±rlÄ±yor musun?</h2>
        <p class="step3-sub">Her biri Ä°stanbul'un bir kÃ¶ÅŸesinde saklÄ±...</p>
        <div class="step3-tap">dokun ğŸ—ºï¸</div>
      </div>
    </div>

    <!-- ==========================================
         INTRO â€” Step 4: Mission
         ========================================== -->
    <div class="intro-step step-4" id="step-4">
      <div class="step-content">
        <div class="mission-badge">ğŸ®</div>
        <h2 class="step4-title">GÃ¶rev: AnÄ±larÄ± KeÅŸfet</h2>
        <div class="mission-rules">
          <div class="rule"><span class="rule-icon">ğŸ—ºï¸</span><span>Haritaya dokunarak ilerle</span></div>
          <div class="rule"><span class="rule-icon">ğŸ®</span><span>YÃ¶n tuÅŸlarÄ±yla kontrol et</span></div>
          <div class="rule"><span class="rule-icon">â“</span><span>Gizli anÄ±larÄ± sÄ±rayla keÅŸfet</span></div>
          <div class="rule"><span class="rule-icon">ğŸŒ«ï¸</span><span>Sisi aÃ§, hikayeni oluÅŸtur</span></div>
        </div>
        <button class="btn-start" id="btn-start">HazÄ±rÄ±m, BaÅŸla! ğŸ’–</button>
      </div>
    </div>

    <!-- ==========================================
         GAME SCREEN
         ========================================== -->
    <div class="game" id="game" style="display:none;">
      <div id="map"></div>

      <!-- Fog of War Canvas -->
      <canvas id="fog-canvas" class="fog-canvas"></canvas>

      <!-- HUD -->
      <div class="hud">
        <div class="hud-left">
          <div class="hud-score" id="hud-score">
            <span class="hud-heart">ğŸ’•</span>
            <span id="score-text">0 / 5</span>
          </div>
        </div>
        <div class="hud-center">
          <div class="hud-title">Bizim DÃ¼nyamÄ±z</div>
        </div>
        <div class="hud-right">
          <button class="hud-btn" id="btn-compass" title="En yakÄ±n anÄ±ya git">ğŸ§­</button>
        </div>
      </div>

      <!-- Hint Pill -->
      <div class="hint-pill" id="hint-pill">
        <span class="hint-icon">ğŸ—ºï¸</span>
        <span class="hint-text" id="hint-text">Sonraki: ...</span>
      </div>

      <!-- Progress Bar -->
      <div class="game-progress">
        <div class="game-progress-fill" id="progress-fill"></div>
      </div>

      <!-- Warmth Indicator -->
      <div class="distance-badge" id="distance-badge">
        <span class="warmth-dot" id="warmth-dot">ğŸ”µ</span>
        <span class="warmth-label" id="warmth-label">SoÄŸuk</span>
        <span class="distance-sep">Â·</span>
        <span class="distance-arrow" id="distance-arrow">â†‘</span>
        <span class="distance-text" id="distance-text">--</span>
      </div>

      <!-- Toast -->
      <div class="toast" id="toast">
        <span class="toast-emoji">ğŸ’•</span>
        <span class="toast-text" id="toast-text">Yeni anÄ± keÅŸfedildi!</span>
      </div>

      <!-- Discovery Flash -->
      <div class="discovery-flash" id="discovery-flash"></div>

      <!-- Settings Gear -->
      <button class="settings-btn" id="settings-btn" title="Ayarlar">âš™ï¸</button>
      <div class="settings-panel" id="settings-panel">
        <p class="settings-title">Ayarlar</p>
        <button class="settings-reset-btn" id="reset-progress-btn">Ä°lerlemeyi SÄ±fÄ±rla ğŸ”„</button>
        <button class="settings-cancel-btn" id="reset-cancel-btn">Ä°ptal</button>
      </div>

      <!-- D-Pad -->
      <div class="dpad" id="dpad">
        <button class="dpad-btn dpad-up" id="dpad-up" aria-label="YukarÄ±">â–²</button>
        <div class="dpad-mid">
          <button class="dpad-btn dpad-left" id="dpad-left" aria-label="Sol">â—€</button>
          <div class="dpad-center">ğŸ’–</div>
          <button class="dpad-btn dpad-right" id="dpad-right" aria-label="SaÄŸ">â–¶</button>
        </div>
        <button class="dpad-btn dpad-down" id="dpad-down" aria-label="AÅŸaÄŸÄ±">â–¼</button>
      </div>
    </div>

    <!-- ==========================================
         BOTTOM SHEET
         ========================================== -->
    <div class="sheet-overlay" id="sheet-overlay"></div>
    <div class="sheet" id="sheet">
      <div class="sheet-handle"><div class="sheet-handle-bar"></div></div>
      <div class="sheet-body">
        <h3 class="sheet-title" id="ak-baslik">AnÄ±</h3>
        <div class="sheet-date" id="ak-tarih">ğŸ“… Tarih</div>
        <div class="sheet-placeholder" id="ak-placeholder">ğŸ’•</div>
        <img class="sheet-foto" id="ak-foto" alt="AnÄ± fotoÄŸrafÄ±" style="display:none;" />
        <p class="sheet-text" id="ak-metin">Metin</p>
        <button class="btn-sheet-close" id="sheet-close">Tamam ğŸ’›</button>
      </div>
    </div>

    <!-- Fullscreen Photo Lightbox -->
    <div class="lightbox" id="lightbox">
      <button class="lightbox-close" id="lightbox-close">âœ•</button>
      <img class="lightbox-img" id="lightbox-img" alt="FotoÄŸraf" />
    </div>

    <!-- ==========================================
         FINALE OVERLAY
         ========================================== -->
    <div class="finale-overlay" id="finale-overlay">
      <!-- World Map SVG Background -->
      <div class="finale-world-bg">
        <svg class="world-svg" viewBox="0 0 1000 500" xmlns="http://www.w3.org/2000/svg">
          <!-- Simplified world continents in pastel -->
          <ellipse cx="500" cy="250" rx="480" ry="230" fill="none" stroke="rgba(232,128,127,0.15)" stroke-width="2"/>
          <!-- North America -->
          <path d="M150,120 Q170,90 220,85 Q260,80 280,100 Q300,120 290,150 Q280,180 250,200 Q220,220 190,210 Q160,200 140,170 Q130,150 150,120Z" fill="rgba(252,228,236,0.5)" stroke="rgba(232,128,127,0.2)" stroke-width="1"/>
          <!-- South America -->
          <path d="M240,250 Q260,230 280,240 Q300,260 290,300 Q280,340 260,370 Q240,390 230,360 Q220,330 225,290 Q230,260 240,250Z" fill="rgba(243,229,245,0.5)" stroke="rgba(232,128,127,0.2)" stroke-width="1"/>
          <!-- Europe -->
          <path d="M440,100 Q460,80 490,90 Q510,100 520,120 Q530,140 510,155 Q490,165 470,160 Q450,150 440,130 Q435,115 440,100Z" fill="rgba(255,243,224,0.5)" stroke="rgba(232,128,127,0.2)" stroke-width="1"/>
          <!-- Africa -->
          <path d="M460,180 Q480,160 510,170 Q530,190 535,230 Q540,270 530,310 Q510,340 490,350 Q470,340 460,310 Q450,270 455,230 Q458,200 460,180Z" fill="rgba(252,228,236,0.5)" stroke="rgba(232,128,127,0.2)" stroke-width="1"/>
          <!-- Asia -->
          <path d="M540,80 Q580,60 640,70 Q700,80 740,100 Q770,120 760,160 Q740,190 700,200 Q660,210 620,200 Q580,190 560,160 Q540,130 535,105 Q535,90 540,80Z" fill="rgba(243,229,245,0.5)" stroke="rgba(232,128,127,0.2)" stroke-width="1"/>
          <!-- Australia -->
          <path d="M720,300 Q750,280 780,290 Q800,310 790,340 Q770,360 740,350 Q720,340 715,320 Q715,305 720,300Z" fill="rgba(255,243,224,0.5)" stroke="rgba(232,128,127,0.2)" stroke-width="1"/>
          <!-- Heart pin on Istanbul -->
          <g transform="translate(495,130)">
            <circle cx="0" cy="0" r="6" fill="rgba(232,128,127,0.8)">
              <animate attributeName="r" values="6;8;6" dur="2s" repeatCount="indefinite"/>
            </circle>
            <circle cx="0" cy="0" r="12" fill="none" stroke="rgba(232,128,127,0.3)" stroke-width="1">
              <animate attributeName="r" values="12;18;12" dur="2s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.5;0;0.5" dur="2s" repeatCount="indefinite"/>
            </circle>
          </g>
          <!-- Dotted connections between continents -->
          <line x1="280" y1="150" x2="440" y2="120" stroke="rgba(232,128,127,0.15)" stroke-width="1" stroke-dasharray="4,6"/>
          <line x1="510" y1="155" x2="540" y2="120" stroke="rgba(232,128,127,0.15)" stroke-width="1" stroke-dasharray="4,6"/>
          <line x1="700" y1="200" x2="720" y2="300" stroke="rgba(232,128,127,0.15)" stroke-width="1" stroke-dasharray="4,6"/>
        </svg>
      </div>

      <!-- Skip button -->
      <button class="finale-skip" id="finale-skip-btn">Atla â†’</button>

      <!-- Final text -->
      <div class="finale-content">
        <div class="finale-text">
          <h2 class="finale-heading">ğŸŒ</h2>
          <p class="finale-message">Daha birlikte keÅŸfedecek Ã§ok yerimiz var.</p>
        </div>
        <button class="finale-btn" id="finale-continue-btn">Devam edelim mi? ğŸ’›</button>

        <!-- Sweet note area (hidden until button click) -->
        <div class="finale-note-area" id="finale-note-area">
          <div class="finale-note-content">
            <p class="finale-note-text" id="finale-note-text"></p>
          </div>
        </div>
      </div>
    </div>

    <!-- Confetti -->
    <canvas class="confetti-canvas" id="confetti-canvas"></canvas>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="data.js"></script>
    <script src="progressStore.js"></script>
    <script src="markerManager.js"></script>
    <script src="fogOverlay.js"></script>
    <script src="finaleSequence.js"></script>
    <script src="app.js"></script>
  </body>
</html>
